<!DOCTYPE HTML>
<html>

    <head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<meta name="description" content="MFA Student at London Business School with a Passion for Finance">
	<meta name="author" content="Elia Waidele">
	<meta name="generator" content="Hugo 0.75.1" />
	<title>Climate Change and Temperature Anomalies &middot; Portfolio Website for Elia Waidele</title>
	<!-- Stylesheets -->
	
	<link rel="stylesheet" href="/css/main.css"/>
	
	

	

	<!-- Custom Fonts -->
	<link href="/css/font-awesome.min.css" rel="stylesheet" type="text/css">

	
	<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
	<link rel="icon" type="image/x-icon" href="/favicon.ico">
	

	<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
	<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
	<!--[if lt IE 9]>
	<script src="js/ie/html5shiv.js"></script>
	<script src="js/ie/html5shiv.jsrespond.min.js"></script>
	<![endif]-->
</head>

    <body>

    <!-- Wrapper -->
        <div id="wrapper">

            <!-- Header -->
    <header id="header" class="alt">
        <a href="/" class="logo"><strong>Elia Waidele</strong> <span>MFA2021</span></a>
        <nav>
            <a href="#menu">Menu</a>
        </nav>
    </header>

<!-- Menu -->
    <nav id="menu">
        <ul class="links">
            
                <li><a href="/">Home</a></li>
            

        </ul>
        <ul class="actions vertical">
            
            
        </ul>
    </nav>

        <!-- Main -->
            <div id="main" class="alt">

                
                    <section id="one">
                        <div class="inner">
                            <header class="major">
                                <h1>Climate Change and Temperature Anomalies</h1>
                            </header>
                            
                                <span class="image main"><img src="/img/Projects/weather.jpeg" alt="" /></span>
                            
                            
<script src="/rmarkdown-libs/kePrint/kePrint.js"></script>
<link href="/rmarkdown-libs/lightable/lightable.css" rel="stylesheet" />


<p>For our study of climate change and temperature anomalies we can find data on the <em>Combined Land-Surface Air and Sea-Surface Water Temperature Anomalies</em> in the Northern Hemisphere at <a href="https://data.giss.nasa.gov/gistemp">NASA’s Goddard Institute for Space Studies</a>.</p>
<p>We use the following code to load our data.</p>
<pre class="r"><code>weather &lt;- 
  
  read_csv(&quot;https://data.giss.nasa.gov/gistemp/tabledata_v3/NH.Ts+dSST.csv&quot;, 
           
           skip = 1, 
           
           na = &quot;***&quot;)</code></pre>
<pre class="r"><code>skim(weather)</code></pre>
<table style='width: auto;'
        class='table table-condensed'>
<caption>
<span id="tab:unnamed-chunk-1">Table 1: </span>Data summary
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Name
</td>
<td style="text-align:left;">
weather
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of rows
</td>
<td style="text-align:left;">
140
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of columns
</td>
<td style="text-align:left;">
19
</td>
</tr>
<tr>
<td style="text-align:left;">
_______________________
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Column type frequency:
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
19
</td>
</tr>
<tr>
<td style="text-align:left;">
________________________
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Group variables
</td>
<td style="text-align:left;">
None
</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left;">
skim_variable
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
complete_rate
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
p0
</th>
<th style="text-align:right;">
p25
</th>
<th style="text-align:right;">
p50
</th>
<th style="text-align:right;">
p75
</th>
<th style="text-align:right;">
p100
</th>
<th style="text-align:left;">
hist
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Year
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1949.50
</td>
<td style="text-align:right;">
40.56
</td>
<td style="text-align:right;">
1880.00
</td>
<td style="text-align:right;">
1914.75
</td>
<td style="text-align:right;">
1949.50
</td>
<td style="text-align:right;">
1984.25
</td>
<td style="text-align:right;">
2019.00
</td>
<td style="text-align:left;">
&lt;U+2587&gt;&lt;U+2587&gt;&lt;U+2587&gt;&lt;U+2587&gt;&lt;U+2587&gt;
</td>
</tr>
<tr>
<td style="text-align:left;">
Jan
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.53
</td>
<td style="text-align:right;">
-1.47
</td>
<td style="text-align:right;">
-0.35
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.35
</td>
<td style="text-align:right;">
1.55
</td>
<td style="text-align:left;">
&lt;U+2581&gt;&lt;U+2585&gt;&lt;U+2587&gt;&lt;U+2583&gt;&lt;U+2581&gt;
</td>
</tr>
<tr>
<td style="text-align:left;">
Feb
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
0.53
</td>
<td style="text-align:right;">
-0.89
</td>
<td style="text-align:right;">
-0.36
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
0.46
</td>
<td style="text-align:right;">
1.92
</td>
<td style="text-align:left;">
&lt;U+2586&gt;&lt;U+2587&gt;&lt;U+2586&gt;&lt;U+2582&gt;&lt;U+2581&gt;
</td>
</tr>
<tr>
<td style="text-align:left;">
Mar
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
0.51
</td>
<td style="text-align:right;">
-0.77
</td>
<td style="text-align:right;">
-0.27
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
1.83
</td>
<td style="text-align:left;">
&lt;U+2586&gt;&lt;U+2587&gt;&lt;U+2583&gt;&lt;U+2582&gt;&lt;U+2581&gt;
</td>
</tr>
<tr>
<td style="text-align:left;">
Apr
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.45
</td>
<td style="text-align:right;">
-0.68
</td>
<td style="text-align:right;">
-0.27
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
0.26
</td>
<td style="text-align:right;">
1.42
</td>
<td style="text-align:left;">
&lt;U+2585&gt;&lt;U+2587&gt;&lt;U+2583&gt;&lt;U+2582&gt;&lt;U+2581&gt;
</td>
</tr>
<tr>
<td style="text-align:left;">
May
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.39
</td>
<td style="text-align:right;">
-0.74
</td>
<td style="text-align:right;">
-0.23
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
1.03
</td>
<td style="text-align:left;">
&lt;U+2582&gt;&lt;U+2587&gt;&lt;U+2587&gt;&lt;U+2582&gt;&lt;U+2582&gt;
</td>
</tr>
<tr>
<td style="text-align:left;">
Jun
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.38
</td>
<td style="text-align:right;">
-0.56
</td>
<td style="text-align:right;">
-0.20
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.19
</td>
<td style="text-align:right;">
1.15
</td>
<td style="text-align:left;">
&lt;U+2585&gt;&lt;U+2587&gt;&lt;U+2583&gt;&lt;U+2582&gt;&lt;U+2581&gt;
</td>
</tr>
<tr>
<td style="text-align:left;">
Jul
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.35
</td>
<td style="text-align:right;">
-0.60
</td>
<td style="text-align:right;">
-0.18
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
1.02
</td>
<td style="text-align:left;">
&lt;U+2583&gt;&lt;U+2587&gt;&lt;U+2583&gt;&lt;U+2582&gt;&lt;U+2581&gt;
</td>
</tr>
<tr>
<td style="text-align:left;">
Aug
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.36
</td>
<td style="text-align:right;">
-0.76
</td>
<td style="text-align:right;">
-0.21
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
1.08
</td>
<td style="text-align:left;">
&lt;U+2582&gt;&lt;U+2587&gt;&lt;U+2586&gt;&lt;U+2582&gt;&lt;U+2581&gt;
</td>
</tr>
<tr>
<td style="text-align:left;">
Sep
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.36
</td>
<td style="text-align:right;">
-0.70
</td>
<td style="text-align:right;">
-0.17
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
1.18
</td>
<td style="text-align:left;">
&lt;U+2582&gt;&lt;U+2587&gt;&lt;U+2585&gt;&lt;U+2582&gt;&lt;U+2581&gt;
</td>
</tr>
<tr>
<td style="text-align:left;">
Oct
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
0.40
</td>
<td style="text-align:right;">
-0.81
</td>
<td style="text-align:right;">
-0.17
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.27
</td>
<td style="text-align:right;">
1.24
</td>
<td style="text-align:left;">
&lt;U+2581&gt;&lt;U+2587&gt;&lt;U+2587&gt;&lt;U+2582&gt;&lt;U+2582&gt;
</td>
</tr>
<tr>
<td style="text-align:left;">
Nov
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
0.44
</td>
<td style="text-align:right;">
-0.81
</td>
<td style="text-align:right;">
-0.23
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.28
</td>
<td style="text-align:right;">
1.35
</td>
<td style="text-align:left;">
&lt;U+2583&gt;&lt;U+2587&gt;&lt;U+2587&gt;&lt;U+2582&gt;&lt;U+2581&gt;
</td>
</tr>
<tr>
<td style="text-align:left;">
Dec
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.47
</td>
<td style="text-align:right;">
-1.10
</td>
<td style="text-align:right;">
-0.30
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
1.45
</td>
<td style="text-align:left;">
&lt;U+2581&gt;&lt;U+2587&gt;&lt;U+2587&gt;&lt;U+2582&gt;&lt;U+2581&gt;
</td>
</tr>
<tr>
<td style="text-align:left;">
J-D
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.39
</td>
<td style="text-align:right;">
-0.54
</td>
<td style="text-align:right;">
-0.22
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
1.28
</td>
<td style="text-align:left;">
&lt;U+2586&gt;&lt;U+2587&gt;&lt;U+2582&gt;&lt;U+2582&gt;&lt;U+2581&gt;
</td>
</tr>
<tr>
<td style="text-align:left;">
D-N
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.39
</td>
<td style="text-align:right;">
-0.54
</td>
<td style="text-align:right;">
-0.21
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
1.31
</td>
<td style="text-align:left;">
&lt;U+2586&gt;&lt;U+2587&gt;&lt;U+2582&gt;&lt;U+2582&gt;&lt;U+2581&gt;
</td>
</tr>
<tr>
<td style="text-align:left;">
DJF
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.48
</td>
<td style="text-align:right;">
-1.00
</td>
<td style="text-align:right;">
-0.30
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.38
</td>
<td style="text-align:right;">
1.64
</td>
<td style="text-align:left;">
&lt;U+2582&gt;&lt;U+2587&gt;&lt;U+2586&gt;&lt;U+2582&gt;&lt;U+2581&gt;
</td>
</tr>
<tr>
<td style="text-align:left;">
MAM
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
0.43
</td>
<td style="text-align:right;">
-0.66
</td>
<td style="text-align:right;">
-0.25
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
1.43
</td>
<td style="text-align:left;">
&lt;U+2585&gt;&lt;U+2587&gt;&lt;U+2583&gt;&lt;U+2582&gt;&lt;U+2581&gt;
</td>
</tr>
<tr>
<td style="text-align:left;">
JJA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.36
</td>
<td style="text-align:right;">
-0.54
</td>
<td style="text-align:right;">
-0.20
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
1.07
</td>
<td style="text-align:left;">
&lt;U+2585&gt;&lt;U+2587&gt;&lt;U+2583&gt;&lt;U+2582&gt;&lt;U+2581&gt;
</td>
</tr>
<tr>
<td style="text-align:left;">
SON
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
0.39
</td>
<td style="text-align:right;">
-0.67
</td>
<td style="text-align:right;">
-0.21
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
1.24
</td>
<td style="text-align:left;">
&lt;U+2583&gt;&lt;U+2587&gt;&lt;U+2585&gt;&lt;U+2582&gt;&lt;U+2581&gt;
</td>
</tr>
</tbody>
</table>
<p>After taking a first look at the weather data set, we clean our data by dropping variables we do not need and by bringing our data to the longer (tidy) format.</p>
<pre class="r"><code>tidyweather &lt;- weather %&gt;%
  
  select(-&quot;J-D&quot;,-&quot;D-N&quot;,-&quot;DJF&quot;,-&quot;MAM&quot;,-&quot;JJA&quot;,-&quot;SON&quot;) %&gt;%
  
  pivot_longer(cols = 2:13,
               
               names_to = &quot;month&quot;,
               
               values_to = &quot;delta&quot;)</code></pre>
<pre class="r"><code>skim(tidyweather)</code></pre>
<table style='width: auto;'
        class='table table-condensed'>
<caption>
<span id="tab:unnamed-chunk-2">Table 2: </span>Data summary
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Name
</td>
<td style="text-align:left;">
tidyweather
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of rows
</td>
<td style="text-align:left;">
1680
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of columns
</td>
<td style="text-align:left;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
_______________________
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Column type frequency:
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
character
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
________________________
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Group variables
</td>
<td style="text-align:left;">
None
</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left;">
skim_variable
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
complete_rate
</th>
<th style="text-align:right;">
min
</th>
<th style="text-align:right;">
max
</th>
<th style="text-align:right;">
empty
</th>
<th style="text-align:right;">
n_unique
</th>
<th style="text-align:right;">
whitespace
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
month
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left;">
skim_variable
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
complete_rate
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
p0
</th>
<th style="text-align:right;">
p25
</th>
<th style="text-align:right;">
p50
</th>
<th style="text-align:right;">
p75
</th>
<th style="text-align:right;">
p100
</th>
<th style="text-align:left;">
hist
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Year
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1949.50
</td>
<td style="text-align:right;">
40.43
</td>
<td style="text-align:right;">
1880.00
</td>
<td style="text-align:right;">
1914.75
</td>
<td style="text-align:right;">
1949.50
</td>
<td style="text-align:right;">
1984.25
</td>
<td style="text-align:right;">
2019.00
</td>
<td style="text-align:left;">
&lt;U+2587&gt;&lt;U+2587&gt;&lt;U+2587&gt;&lt;U+2587&gt;&lt;U+2587&gt;
</td>
</tr>
<tr>
<td style="text-align:left;">
delta
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.44
</td>
<td style="text-align:right;">
-1.47
</td>
<td style="text-align:right;">
-0.24
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
0.29
</td>
<td style="text-align:right;">
1.92
</td>
<td style="text-align:left;">
&lt;U+2581&gt;&lt;U+2586&gt;&lt;U+2587&gt;&lt;U+2582&gt;&lt;U+2581&gt;
</td>
</tr>
</tbody>
</table>
<p>Our new dataframe now has three variables, one each for</p>
<ol style="list-style-type: decimal">
<li>year,</li>
<li>month, and</li>
<li>delta, or temperature deviation.</li>
</ol>
<div id="plotting-information" class="section level2">
<h2>Plotting Information</h2>
<p>We plotted the data using a time-series scatter plot, and added a trendline. To do that, we first need to create a new variable called <code>date</code> in order to ensure that the <code>delta</code> values are plot chronologically.</p>
<pre class="r"><code>tidyweather &lt;- tidyweather %&gt;%
  
  mutate(date = ymd(paste(as.character(Year), month, &quot;1&quot;)),
         
         month = month(date, label=TRUE),
         
         year = year(date))

ggplot(tidyweather, aes(x=date, y = delta))+
  
  geom_point(alpha = 0.5)+
  
  geom_smooth(color=&quot;red&quot;) +
  
  theme_bw() +
  theme(
    plot.title = element_text(face = &quot;bold&quot;)
  )+
  
  labs (
    
    title = &quot;Weather Anomalies&quot;,
    
    subtitle = &quot;Development of temperature deviations&quot;,
    
    x = &quot;Year&quot;,
    
    y = &quot;Temperature Deviation&quot;
    )</code></pre>
<p><img src="/Projects/Project2/index_files/figure-html/scatter_plot-1.png" width="648" style="display: block; margin: auto;" /></p>
<blockquote>
<p>Above plot displays an increase in weather anomalies over time.</p>
</blockquote>
<p>As the plot above only provides limited information, we will plot the same data faceted by month in order to obtain a more thorough understanding of the data.</p>
<pre class="r"><code>ggplot(tidyweather, aes(x=date, y = delta))+
  
  geom_point()+
  
  geom_smooth(color=&quot;red&quot;) +
  
  theme_bw() +
  
  facet_wrap(&quot;month&quot;) +
  
  labs (
    
    title = &quot;Weather Anomalies&quot;,
    
    subtitle = &quot;Development of temperature deviations&quot;,
    
    x = &quot;Year&quot;,
    
    y = &quot;Monthly Temperature Deviation&quot;
    )</code></pre>
<p><img src="/Projects/Project2/index_files/figure-html/facet_wrap-1.png" width="648" style="display: block; margin: auto;" /></p>
<blockquote>
<p>Generally, the plot displays a rise in temperature anomalies in all twelve months. However, it seems like weather anomalies are in average more likely to arise in winter and spring months than in the summer. Beyond that, the colder months display a higher deviation from the mean, represented by the distance of the points from the respective lines.</p>
</blockquote>
<p>It is sometimes useful to group data into different time periods to study historical data. Hence, in the following, we create a new data frame called <code>comparison</code> that groups data in five time periods: 1881-1920, 1921-1950, 1951-1980, 1981-2010 and 2011-present.</p>
<p>In that regard, we remove data before 1800 and before using <code>filter</code>. Then, we use the <code>mutate</code> function to create a new variable <code>interval</code> which contains information on which period each observation belongs to. We can assign the different periods using <code>case_when()</code>.</p>
<pre class="r"><code>comparison &lt;- tidyweather %&gt;% 
  filter(Year&gt;= 1881) %&gt;%     #remove years prior to 1881
  #create new variable &#39;interval&#39;, and assign values based on criteria below:
  mutate(interval = case_when(
    Year %in% c(1881:1920) ~ &quot;1881-1920&quot;,
    Year %in% c(1921:1950) ~ &quot;1921-1950&quot;,
    Year %in% c(1951:1980) ~ &quot;1951-1980&quot;,
    Year %in% c(1981:2010) ~ &quot;1981-2010&quot;,
    TRUE ~ &quot;2011-present&quot;
  ))

comparison</code></pre>
<pre><code>## # A tibble: 1,668 x 6
##     Year month delta date        year interval 
##    &lt;dbl&gt; &lt;ord&gt; &lt;dbl&gt; &lt;date&gt;     &lt;dbl&gt; &lt;chr&gt;    
##  1  1881 Jan   -0.19 1881-01-01  1881 1881-1920
##  2  1881 Feb   -0.25 1881-02-01  1881 1881-1920
##  3  1881 Mar    0.02 1881-03-01  1881 1881-1920
##  4  1881 Apr   -0.02 1881-04-01  1881 1881-1920
##  5  1881 May   -0.06 1881-05-01  1881 1881-1920
##  6  1881 Jun   -0.36 1881-06-01  1881 1881-1920
##  7  1881 Jul   -0.06 1881-07-01  1881 1881-1920
##  8  1881 Aug   -0.03 1881-08-01  1881 1881-1920
##  9  1881 Sep   -0.23 1881-09-01  1881 1881-1920
## 10  1881 Oct   -0.4  1881-10-01  1881 1881-1920
## # ... with 1,658 more rows</code></pre>
<p>We now use the <code>interval</code> variable to create a density plot to study the distribution of monthly deviations (<code>delta</code>), grouped by the different time periods we are interested in.</p>
<pre class="r"><code>ggplot(comparison, aes(x=delta, fill=interval))+
  
  geom_density(alpha=0.2) +
  
  theme_bw() +   
  
  labs (
    title = &quot;Density Plot for Monthly Temperature Anomalies&quot;,
    
    y     = &quot;Density&quot;
  )</code></pre>
<p><img src="/Projects/Project2/index_files/figure-html/density_plot-1.png" width="648" style="display: block; margin: auto;" /></p>
<p>So far, we have been working with monthly anomalies. However, we might be interested in average annual anomalies. We can do this by using <code>group_by()</code> and <code>summarise()</code>, followed by a scatter plot to display the result.</p>
<pre class="r"><code>#creating yearly averages

average_annual_anomaly &lt;- tidyweather %&gt;%
  
  #grouping data by Year
  
  group_by(Year) %&gt;%
  
  # creating summaries for mean delta 
  # use `na.rm=TRUE` to eliminate NA (not available) values 
  
  summarise(annual_average_delta = mean(delta, na.rm=TRUE)) 

#plotting the data:

ggplot(average_annual_anomaly, aes(x=Year, y= annual_average_delta))+
  geom_point()+
  
  #Fit the best fit line, using LOESS method
  
  geom_smooth() +
  
  #change to theme_bw() to have white background + black frame around plot
  
  theme_bw() +
  labs (
    title = &quot;Average Yearly Weather Anomaly&quot;,
    y     = &quot;Average Annual Delta&quot;
  )                         </code></pre>
<p><img src="/Projects/Project2/index_files/figure-html/averaging-1.png" width="648" style="display: block; margin: auto;" /></p>
<blockquote>
<p>The above plot shows that in the past c. 60 years the climate faced a 1 degree change wich is significant considering the impact of small changes in temperature on the overall climate.</p>
</blockquote>
</div>
<div id="confidence-interval-for-delta" class="section level2">
<h2>Confidence Interval for <code>delta</code></h2>
<p>After visualizing our data, we construct a confidence interval for the average annual delta since 2011 using two different approaches.</p>
<div id="formula" class="section level3">
<h3>1. Formula</h3>
<pre class="r"><code>formula_ci &lt;- comparison %&gt;%
  
  filter(interval==&quot;2011-present&quot;) %&gt;%
  
     summarise(mean = mean(delta, na.rm = TRUE),
                         SD = sd(delta, na.rm = TRUE),
                         count=n(),
                         SE = SD/sqrt(count),
                         lower_ci = mean - 1.96*SE,
                         upper_ci = mean + 1.96*SE)

formula_ci %&gt;%
  
  kbl(caption = &#39;Confidence Interval for the Annual Delta since 2011&#39;)%&gt;%
  
  kable_styling()</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
(#tab:calculate_CI_using_formula)Confidence Interval for the Annual Delta since 2011
</caption>
<thead>
<tr>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
SD
</th>
<th style="text-align:right;">
count
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
lower_ci
</th>
<th style="text-align:right;">
upper_ci
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.966
</td>
<td style="text-align:right;">
0.262
</td>
<td style="text-align:right;">
108
</td>
<td style="text-align:right;">
0.025
</td>
<td style="text-align:right;">
0.916
</td>
<td style="text-align:right;">
1.01
</td>
</tr>
</tbody>
</table>
</div>
<div id="bootstrap-simulation-using-infer-package" class="section level3">
<h3>2. Bootstrap simulation using <code>infer</code> package</h3>
<pre class="r"><code># use the infer package to construct a 95% CI for delta

# calculating confidence interval with bootstrapping

bootstrap_delta &lt;- comparison %&gt;%
  
  filter(Year &gt;= 2011) %&gt;%
  
  specify(response = delta) %&gt;%
  
  generate(reps = 1000, type = &quot;bootstrap&quot;) %&gt;%
  
  calculate(stat = &quot;mean&quot;)

infer_ci &lt;- bootstrap_delta %&gt;%
  
  get_confidence_interval(level = 0.95,type = &quot;percentile&quot;)

infer_ci %&gt;%
  
  kbl(caption = &#39;Confidence Interval for the Annual Delta since 2011 using bootstrapping&#39;)%&gt;%
  
  kable_styling()</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
(#tab:calculate_CI_using_bootstrap)Confidence Interval for the Annual Delta since 2011 using bootstrapping
</caption>
<thead>
<tr>
<th style="text-align:right;">
lower_ci
</th>
<th style="text-align:right;">
upper_ci
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.917
</td>
<td style="text-align:right;">
1.01
</td>
</tr>
</tbody>
</table>
<blockquote>
<p>From the analysis of the sample database, we are 95% confident that the interval (0.915, 1.02) captures the true population mean. In other words, if we make 20 repeated observations and calculate 95% confidence intervals for each observation, we can expect that around 19 of those intervals will contain the true annual delta since 2011.</p>
</blockquote>
</div>
</div>

                        </div>
                    </section>
            <!-- Disqus Inject -->
                
            </div>
            
        <!-- Footer -->
            
                <!-- Footer -->
    <footer id="footer">
        <div class="inner">
            <ul class="icons">
                
                    <li><a href="https://github.com/ewaidele" class="icon alt fa-github" target="_blank"><span class="label">GitHub</span></a></li>
                
                    <li><a href="https://www.linkedin.com/in/elia-waidele-668312151/" class="icon alt fa-linkedin" target="_blank"><span class="label">LinkedIn</span></a></li>
                
            </ul>
            <ul class="copyright">
                <li>&copy; Elia Waidele</li>
                
            </ul>
        </div>
    </footer>

            
        </div>

    <!-- Scripts -->
        <!-- Scripts -->
    <!-- jQuery -->
    <script src="/js/jquery.min.js"></script>
    <script src="/js/jquery.scrolly.min.js"></script>
    <script src="/js/jquery.scrollex.min.js"></script>
    <script src="/js/skel.min.js"></script>
    <script src="/js/util.js"></script>

    

    <!-- Main JS -->
    <script src="/js/main.js"></script>

    

    

    </body>
</html>
